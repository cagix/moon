(ns gdl.create.audio
  (:require [gdl.audio]
            [gdl.files :as files]
            [gdl.utils.assets :as assets]
            [gdl.utils.disposable :refer [dispose!]]
            [gdx.audio :as audio]
            [gdx.audio.sound :as sound]))

(comment
 (def sound-paths
   (vec (assets/search (.internal com.badlogic.gdx.Gdx/files "resources/") #{"wav"})))
 )

(def sound-paths
   ["sounds/bfxr_armorhit.wav" "sounds/bfxr_coinget.wav" "sounds/fanfare10.wav" "sounds/bfxr_bossdeath.wav" "sounds/bfxr_playerdeath.wav" "sounds/bfxr_healmonsters.wav" "sounds/bfxr_drugsuse.wav" "sounds/slash.wav" "sounds/pickup.wav" "sounds/bfxr_instanthealer_heal.wav" "sounds/bfxr_playerhit.wav" "sounds/bfxr_cast.wav" "sounds/bfxr_projectile_wallhit.wav" "sounds/bfxr_caveenter.wav" "sounds/bfxr_rayshooterhit.wav" "sounds/bfxr_denied.wav" "sounds/bfxr_click.wav" "sounds/bfxr_takeit.wav" "sounds/bfxr_pickup.wav" "sounds/bfxr_dronedeath.wav" "sounds/bfxr_merchanttalk.wav" "sounds/bfxr_itemput.wav" "sounds/bfxr_teleport.wav" "sounds/bfxr_defaultmonsterdeath.wav" "sounds/bfxr_itemputground.wav" "sounds/bfxr_stationdeath.wav" "sounds/bfxr_curse.wav" "sounds/shoot.wav" "sounds/ReversyH-Nick_Ros-105.wav" "sounds/bfxr_shield_consume.wav" "sounds/bfxr_normalhit.wav" "sounds/bfxr_portaluse.wav" "sounds/bfxr_fisthit.wav" "sounds/bfxr_potionuse.wav" "sounds/bfxr_unburrow.wav" "sounds/bfxr_monkheal.wav" "sounds/explode-erco.wav" "sounds/bfxr_psibolt.wav" "sounds/bfxr_minedeath.wav" "sounds/bfxr_questget.wav" "sounds/bfxr_grenade.wav" "sounds/kabloom.wav" "sounds/bfxr_bigmeleeteleport.wav" "sounds/bfxr_playerteleport.wav" "sounds/bfxr_powerup.wav" "sounds/bfxr_chestopen.wav" "sounds/bfxr_waypointunlock.wav" "sounds/bfxr_burrow.wav" "sounds/bfxr_monstercast.wav" "sounds/oryx_8-bit_sounds/misc/clack.wav" "sounds/oryx_8-bit_sounds/misc/step.wav" "sounds/oryx_8-bit_sounds/misc/bay_door_close.wav" "sounds/oryx_8-bit_sounds/misc/fall.wav" "sounds/oryx_8-bit_sounds/misc/close_shut.wav" "sounds/oryx_8-bit_sounds/misc/swerve.wav" "sounds/oryx_8-bit_sounds/misc/computer_a.wav" "sounds/oryx_8-bit_sounds/misc/computer_b.wav" "sounds/oryx_8-bit_sounds/misc/computer_c.wav" "sounds/oryx_8-bit_sounds/misc/mushroom.wav" "sounds/oryx_8-bit_sounds/misc/rebound.wav" "sounds/oryx_8-bit_sounds/misc/collect_a.wav" "sounds/oryx_8-bit_sounds/misc/bay_door_open.wav" "sounds/oryx_8-bit_sounds/misc/collect_b.wav" "sounds/oryx_8-bit_sounds/misc/shriek.wav" "sounds/oryx_8-bit_sounds/misc/whistle.wav" "sounds/oryx_8-bit_sounds/misc/computer_d.wav" "sounds/oryx_8-bit_sounds/misc/computer_e.wav" "sounds/oryx_8-bit_sounds/misc/zong.wav" "sounds/oryx_8-bit_sounds/misc/open.wav" "sounds/oryx_8-bit_sounds/misc/scatter.wav" "sounds/oryx_8-bit_sounds/misc/drip.wav" "sounds/oryx_8-bit_sounds/misc/unlock.wav" "sounds/oryx_8-bit_sounds/misc/chime.wav" "sounds/oryx_8-bit_sounds/misc/transistor.wav" "sounds/oryx_8-bit_sounds/misc/close.wav" "sounds/oryx_8-bit_sounds/misc/resurrect.wav" "sounds/oryx_8-bit_sounds/misc/wave.wav" "sounds/oryx_8-bit_sounds/misc/wiggle_b.wav" "sounds/oryx_8-bit_sounds/misc/blurb.wav" "sounds/oryx_8-bit_sounds/misc/dong.wav" "sounds/oryx_8-bit_sounds/misc/wiggle_a.wav" "sounds/oryx_8-bit_sounds/misc/scramble.wav" "sounds/oryx_8-bit_sounds/misc/twing.wav" "sounds/oryx_8-bit_sounds/misc/shut.wav" "sounds/oryx_8-bit_sounds/misc/rubberband.wav" "sounds/oryx_8-bit_sounds/misc/ping.wav" "sounds/oryx_8-bit_sounds/interface/select_b.wav" "sounds/oryx_8-bit_sounds/interface/select_a.wav" "sounds/oryx_8-bit_sounds/interface/end_turn.wav" "sounds/oryx_8-bit_sounds/interface/bonus.wav" "sounds/oryx_8-bit_sounds/interface/paper.wav" "sounds/oryx_8-bit_sounds/interface/lose_a.wav" "sounds/oryx_8-bit_sounds/interface/lose_b.wav" "sounds/oryx_8-bit_sounds/interface/new_turn.wav" "sounds/oryx_8-bit_sounds/interface/gold.wav" "sounds/oryx_8-bit_sounds/interface/1up_a.wav" "sounds/oryx_8-bit_sounds/interface/blip.wav" "sounds/oryx_8-bit_sounds/interface/1up_b.wav" "sounds/oryx_8-bit_sounds/interface/coin.wav" "sounds/oryx_8-bit_sounds/interface/click.wav" "sounds/oryx_8-bit_sounds/interface/error.wav" "sounds/oryx_8-bit_sounds/interface/score.wav" "sounds/oryx_8-bit_sounds/interface/dong.wav" "sounds/oryx_8-bit_sounds/interface/level_up.wav" "sounds/oryx_8-bit_sounds/interface/ding.wav" "sounds/oryx_8-bit_sounds/impacts/boom_a.wav" "sounds/oryx_8-bit_sounds/impacts/boom_b.wav" "sounds/oryx_8-bit_sounds/impacts/impact_b.wav" "sounds/oryx_8-bit_sounds/impacts/impact_a.wav" "sounds/oryx_8-bit_sounds/impacts/explode_a.wav" "sounds/oryx_8-bit_sounds/impacts/pit_trap_fall.wav" "sounds/oryx_8-bit_sounds/impacts/sear.wav" "sounds/oryx_8-bit_sounds/impacts/explode_b.wav" "sounds/oryx_8-bit_sounds/impacts/explode_c.wav" "sounds/oryx_8-bit_sounds/impacts/magic_crumble.wav" "sounds/oryx_8-bit_sounds/impacts/area_effect_a.wav" "sounds/oryx_8-bit_sounds/impacts/area_effect_b.wav" "sounds/oryx_8-bit_sounds/impacts/pit_trap_damage.wav" "sounds/oryx_8-bit_sounds/impacts/spike_trap_a.wav" "sounds/oryx_8-bit_sounds/impacts/hit.wav" "sounds/oryx_8-bit_sounds/impacts/spike_trap_b.wav" "sounds/oryx_8-bit_sounds/impacts/magic_dust_b.wav" "sounds/oryx_8-bit_sounds/impacts/magic_dust_a.wav" "sounds/oryx_8-bit_sounds/status/curse.wav" "sounds/oryx_8-bit_sounds/status/freeze.wav" "sounds/oryx_8-bit_sounds/status/mutation.wav" "sounds/oryx_8-bit_sounds/status/confuse.wav" "sounds/oryx_8-bit_sounds/status/disease.wav" "sounds/oryx_8-bit_sounds/status/burn.wav" "sounds/oryx_8-bit_sounds/status/charm.wav" "sounds/oryx_8-bit_sounds/status/poison.wav" "sounds/oryx_8-bit_sounds/abilities/jump_a.wav" "sounds/oryx_8-bit_sounds/abilities/disarm_single.wav" "sounds/oryx_8-bit_sounds/abilities/jump_b.wav" "sounds/oryx_8-bit_sounds/abilities/disarm_multi_b.wav" "sounds/oryx_8-bit_sounds/abilities/heal_b.wav" "sounds/oryx_8-bit_sounds/abilities/laser_a.wav" "sounds/oryx_8-bit_sounds/abilities/disarm_success.wav" "sounds/oryx_8-bit_sounds/abilities/sorcery.wav" "sounds/oryx_8-bit_sounds/abilities/disarm_multi_a.wav" "sounds/oryx_8-bit_sounds/abilities/heal_a.wav" "sounds/oryx_8-bit_sounds/abilities/laser_b.wav" "sounds/oryx_8-bit_sounds/abilities/blaster.wav" "sounds/oryx_8-bit_sounds/abilities/woosh_a.wav" "sounds/oryx_8-bit_sounds/abilities/bazooka.wav" "sounds/oryx_8-bit_sounds/abilities/swing.wav" "sounds/oryx_8-bit_sounds/abilities/fire_a.wav" "sounds/oryx_8-bit_sounds/abilities/woosh_b.wav" "sounds/oryx_8-bit_sounds/abilities/fire_b.wav" "sounds/oryx_8-bit_sounds/abilities/fire_c.wav" "sounds/oryx_8-bit_sounds/abilities/special_b.wav" "sounds/oryx_8-bit_sounds/abilities/spell_a.wav" "sounds/oryx_8-bit_sounds/abilities/teleport.wav" "sounds/oryx_8-bit_sounds/abilities/special_a.wav" "sounds/oryx_8-bit_sounds/abilities/spell_b.wav" "sounds/oryx_8-bit_sounds/abilities/shoot_b.wav" "sounds/oryx_8-bit_sounds/abilities/shoot_a.wav" "sounds/oryx_8-bit_sounds/abilities/reload.wav" "sounds/oryx_8-bit_sounds/abilities/attack_a.wav" "sounds/oryx_8-bit_sounds/abilities/attack_b.wav" "sounds/oryx_8-bit_sounds/abilities/shotgun.wav" "sounds/oryx_8-bit_sounds/abilities/lightning_a.wav" "sounds/oryx_8-bit_sounds/abilities/summon.wav" "sounds/oryx_8-bit_sounds/abilities/lightning_b.wav" "sounds/oryx_8-bit_sounds/abilities/telepathy.wav" "sounds/oryx_8-bit_sounds/creatures/bird.wav" "sounds/oryx_8-bit_sounds/creatures/wings.wav" "sounds/oryx_8-bit_sounds/creatures/skeleton.wav" "sounds/oryx_8-bit_sounds/creatures/beetle.wav" "sounds/oryx_8-bit_sounds/creatures/mystical.wav" "sounds/oryx_8-bit_sounds/creatures/claw.wav" "sounds/oryx_8-bit_sounds/creatures/jelly.wav" "sounds/oryx_8-bit_sounds/creatures/snake.wav" "sounds/oryx_8-bit_sounds/creatures/mouse.wav" "sounds/oryx_8-bit_sounds/creatures/swarm.wav" "sounds/oryx_8-bit_sounds/creatures/frog.wav"]
   )

(defn do!
  [{:keys [ctx/audio
           ctx/files]}
   {:keys [sounds]}]
  (let [{:keys [folder extensions]} sounds
        sounds (into {}
                     (for [path sound-paths
                           #_(assets/search (files/internal files folder) extensions)
                           ]
                       [path (audio/new-sound audio (files/internal files path))]))]
    (reify
      gdl.utils.disposable/Disposable
      (dispose! [_]
        (run! dispose! (vals sounds)))

      gdl.audio/Audio
      (all-sounds [_]
        (map first sounds))

      (play-sound! [_ path]
        (assert (contains? sounds path) (str path))
        (sound/play! (get sounds path))))))
